<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LBANN: include/lbann/lbann_comm.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<h1>include/lbann/lbann_comm.hpp</h1><a href="lbann__comm_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">// Copyright (c) 2014-2016, Lawrence Livermore National Security, LLC. </span>
<a name="l00003"></a>00003 <span class="comment">// Produced at the Lawrence Livermore National Laboratory. </span>
<a name="l00004"></a>00004 <span class="comment">// Written by the LBANN Research Team (B. Van Essen, et al.) listed in</span>
<a name="l00005"></a>00005 <span class="comment">// the CONTRIBUTORS file. &lt;lbann-dev@llnl.gov&gt;</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 <span class="comment">// LLNL-CODE-697807.</span>
<a name="l00008"></a>00008 <span class="comment">// All rights reserved.</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">// This file is part of LBANN: Livermore Big Artificial Neural Network</span>
<a name="l00011"></a>00011 <span class="comment">// Toolkit. For details, see http://software.llnl.gov/LBANN or</span>
<a name="l00012"></a>00012 <span class="comment">// https://github.com/LLNL/LBANN. </span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;Licensee&quot;); you</span>
<a name="l00015"></a>00015 <span class="comment">// may not use this file except in compliance with the License.  You may</span>
<a name="l00016"></a>00016 <span class="comment">// obtain a copy of the License at:</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">// http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00019"></a>00019 <span class="comment">//</span>
<a name="l00020"></a>00020 <span class="comment">// Unless required by applicable law or agreed to in writing, software</span>
<a name="l00021"></a>00021 <span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00022"></a>00022 <span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or</span>
<a name="l00023"></a>00023 <span class="comment">// implied. See the License for the specific language governing</span>
<a name="l00024"></a>00024 <span class="comment">// permissions and limitations under the license.</span>
<a name="l00025"></a>00025 <span class="comment">//</span>
<a name="l00026"></a>00026 <span class="comment">// lbann_comm .hpp .cpp - LBANN communication utilities</span>
<a name="l00028"></a>00028 <span class="comment"></span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef LBANN_COMM_HPP_INCLUDED</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define LBANN_COMM_HPP_INCLUDED</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="lbann__base_8hpp.html">lbann_base.hpp</a>&quot;</span>
<a name="l00034"></a>00034 <span class="keyword">using namespace </span>El;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">namespace </span>lbann
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038 
<a name="l00039"></a>00039   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00040"></a>00040   <span class="keyword">using</span> lbann_mpi_req = mpi::Request&lt;T&gt;;
<a name="l00041"></a>00041 
<a name="l00051"></a><a class="code" href="classlbann_1_1lbann__comm.html">00051</a>   <span class="keyword">class </span><a class="code" href="classlbann_1_1lbann__comm.html">lbann_comm</a>
<a name="l00052"></a>00052   {
<a name="l00053"></a>00053   <span class="keyword">public</span>:
<a name="l00058"></a>00058     <a class="code" href="classlbann_1_1lbann__comm.html#a9f9eb5d1e219d3dcab9b14f790b30e26">lbann_comm</a>(<span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cb55d127259d7ed9f07ccde6f4ebd8c">procs_per_model</a> = 0);
<a name="l00059"></a>00059     <a class="code" href="classlbann_1_1lbann__comm.html#af17b1093313c5e4223f9036798f9e12f">~lbann_comm</a>();
<a name="l00060"></a>00060 
<a name="l00062"></a><a class="code" href="classlbann_1_1lbann__comm.html#a6c201108eb6b5a1e23021db29cef655b">00062</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a6c201108eb6b5a1e23021db29cef655b">get_model_rank</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a1f3f90a996dbba4cd1cca60596933ea3">model_rank</a>; }
<a name="l00064"></a><a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">00064</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>; }
<a name="l00066"></a><a class="code" href="classlbann_1_1lbann__comm.html#a615265cd20ffb4863089bb94e4c82fe7">00066</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a615265cd20ffb4863089bb94e4c82fe7">get_rank_in_world</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mpi::Rank(mpi::COMM_WORLD); }
<a name="l00068"></a><a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">00068</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(<span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank)<span class="keyword"> const </span>{
<a name="l00069"></a>00069       <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cb55d127259d7ed9f07ccde6f4ebd8c">procs_per_model</a> * model + rank;
<a name="l00070"></a>00070     }
<a name="l00072"></a><a class="code" href="classlbann_1_1lbann__comm.html#ad61b35af881db9671f3d71ddbf1ced3f">00072</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad61b35af881db9671f3d71ddbf1ced3f">get_model_master</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00074"></a><a class="code" href="classlbann_1_1lbann__comm.html#aae7d094141d0da3bcacd542605f3e42d">00074</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#aae7d094141d0da3bcacd542605f3e42d">get_intermodel_master</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00076"></a><a class="code" href="classlbann_1_1lbann__comm.html#ac1bcd6a5e38ad3a7e86171435642bc9f">00076</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac1bcd6a5e38ad3a7e86171435642bc9f">get_world_master</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00078"></a><a class="code" href="classlbann_1_1lbann__comm.html#a06a31f9df1860358ef0ef68d9e165cac">00078</a>     <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classlbann_1_1lbann__comm.html#a06a31f9df1860358ef0ef68d9e165cac">am_model_master</a>()<span class="keyword"> const </span>{
<a name="l00079"></a>00079       <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>() == <a class="code" href="classlbann_1_1lbann__comm.html#ad61b35af881db9671f3d71ddbf1ced3f">get_model_master</a>();
<a name="l00080"></a>00080     }
<a name="l00082"></a><a class="code" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">00082</a>     <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">am_world_master</a>()<span class="keyword"> const </span>{
<a name="l00083"></a>00083       <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a615265cd20ffb4863089bb94e4c82fe7">get_rank_in_world</a>() == <a class="code" href="classlbann_1_1lbann__comm.html#ac1bcd6a5e38ad3a7e86171435642bc9f">get_world_master</a>();
<a name="l00084"></a>00084     }
<a name="l00086"></a><a class="code" href="classlbann_1_1lbann__comm.html#a483bf8a72d44a0e83da45f3d47bd20d4">00086</a>     <span class="keyword">inline</span> <a class="code" href="lbann__base_8hpp.html#a4c600bf682fbf8018385607476e4bd13">Grid</a>&amp; <a class="code" href="classlbann_1_1lbann__comm.html#a483bf8a72d44a0e83da45f3d47bd20d4">get_model_grid</a>() { <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1lbann__comm.html#a29fb31be115db3225b145f250a7778d9">grid</a>; }
<a name="l00088"></a><a class="code" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637">00088</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637">get_num_models</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a256ff5a0bafb33f43784ffc8dd2d29cf">num_models</a>; }
<a name="l00089"></a>00089     <span class="comment">/* Return the number of processes in a model. */</span>
<a name="l00090"></a><a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">00090</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">get_procs_per_model</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cb55d127259d7ed9f07ccde6f4ebd8c">procs_per_model</a>; }
<a name="l00092"></a><a class="code" href="classlbann_1_1lbann__comm.html#a845c62c2a55ef3eb4416deb3e8c5cd1a">00092</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a845c62c2a55ef3eb4416deb3e8c5cd1a">get_procs_per_node</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a2ffc59f0c1d97df2ca6845312c8c8b3e">procs_per_node</a>; }
<a name="l00094"></a><a class="code" href="classlbann_1_1lbann__comm.html#a339bc17f07a2e40663df8b5d8cf80bf6">00094</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a339bc17f07a2e40663df8b5d8cf80bf6">get_rank_in_node</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#abb5c8b008b5cac11702bf1f991c78ab0">rank_in_node</a>; }
<a name="l00095"></a>00095 
<a name="l00097"></a>00097     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a68b36ba64db34f33cb135bc64c4623e0">intermodel_sum_matrix</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat);
<a name="l00098"></a>00098     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a68b36ba64db34f33cb135bc64c4623e0">intermodel_sum_matrix</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat);
<a name="l00100"></a>00100     <span class="comment">//void nb_intermodel_sum_matrix(Mat&amp; mat, mpi::Request&amp; req);</span>
<a name="l00101"></a>00101     <span class="comment">//void nb_intermodel_sum_matrix(DistMat&amp; mat, mpi::Request&amp; req);</span>
<a name="l00103"></a>00103 <span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a4989229db1ee858c5a2170a989653d0b">intermodel_broadcast_matrix</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> root);
<a name="l00104"></a>00104     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a4989229db1ee858c5a2170a989653d0b">intermodel_broadcast_matrix</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> root);
<a name="l00106"></a>00106     <span class="comment">//void nb_intermodel_broadcast_matrix(Mat&amp; mat, int root, mpi::Request&amp; req);</span>
<a name="l00107"></a>00107     <span class="comment">//void nb_intermodel_broadcast_matrix(DistMat&amp; mat, int root,</span>
<a name="l00108"></a>00108     <span class="comment">//                                    mpi::Request&amp; req);</span>
<a name="l00113"></a>00113 <span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00114"></a><a class="code" href="classlbann_1_1lbann__comm.html#a240653ee7358a5c535560f3c26118a63">00114</a>     T <a class="code" href="classlbann_1_1lbann__comm.html#a240653ee7358a5c535560f3c26118a63">intermodel_broadcast</a>(<span class="keywordtype">int</span> root, T val = {}) {
<a name="l00115"></a>00115       mpi::Broadcast(&amp;val, 1, root, <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00116"></a>00116       <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>() == root) {
<a name="l00117"></a>00117         <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00118"></a>00118       } <span class="keywordflow">else</span> {
<a name="l00119"></a>00119         <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T);
<a name="l00120"></a>00120       }
<a name="l00121"></a>00121       <span class="keywordflow">return</span> val;
<a name="l00122"></a>00122     }
<a name="l00127"></a>00127     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00128"></a><a class="code" href="classlbann_1_1lbann__comm.html#ab6ee3cdfeeca2aebeb692a720f2dea51">00128</a>     T <a class="code" href="classlbann_1_1lbann__comm.html#ab6ee3cdfeeca2aebeb692a720f2dea51">model_broadcast</a>(<span class="keywordtype">int</span> root, T val = {}) {
<a name="l00129"></a>00129       mpi::Broadcast(&amp;val, 1, root, <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00130"></a>00130       <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>() == root) {
<a name="l00131"></a>00131         <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00132"></a>00132       } <span class="keywordflow">else</span> {
<a name="l00133"></a>00133         <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T);
<a name="l00134"></a>00134       }
<a name="l00135"></a>00135       <span class="keywordflow">return</span> val;
<a name="l00136"></a>00136     }
<a name="l00138"></a>00138     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00139"></a><a class="code" href="classlbann_1_1lbann__comm.html#ac9152604fa3bcadad39c41f5451f2ba0">00139</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac9152604fa3bcadad39c41f5451f2ba0">intermodel_gather</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> root) {
<a name="l00140"></a>00140       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00141"></a>00141       mpi::Gather(&amp;send, 1, (T*) <a class="code" href="datatype_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, root, <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00142"></a>00142     }
<a name="l00144"></a>00144     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00145"></a><a class="code" href="classlbann_1_1lbann__comm.html#a79b41f99647a178b22d5251d313d002b">00145</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a79b41f99647a178b22d5251d313d002b">intermodel_gather</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, std::vector&lt;T&gt;&amp; <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>) {
<a name="l00146"></a>00146       mpi::Gather(&amp;send, 1, recv.data(), 1, <a class="code" href="classlbann_1_1lbann__comm.html#a6c201108eb6b5a1e23021db29cef655b">get_model_rank</a>(),
<a name="l00147"></a>00147                   <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00148"></a>00148       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * (<a class="code" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637">get_num_models</a>() - 1);
<a name="l00149"></a>00149     }
<a name="l00151"></a>00151     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00152"></a><a class="code" href="classlbann_1_1lbann__comm.html#ae59454c663226a4b45c09424f71a242b">00152</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ae59454c663226a4b45c09424f71a242b">intermodel_gather</a>(T* <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> root) {
<a name="l00153"></a>00153       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00154"></a>00154       mpi::Gather(send, count, (T*) <a class="code" href="datatype_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, root, <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00155"></a>00155     }
<a name="l00157"></a>00157     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00158"></a><a class="code" href="classlbann_1_1lbann__comm.html#ab3e65c37ecbbcdbe46f28da10e6d9f08">00158</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ab3e65c37ecbbcdbe46f28da10e6d9f08">intermodel_gather</a>(T* <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> count, T* <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>) {
<a name="l00159"></a>00159       mpi::Gather(send, count, recv, count, <a class="code" href="classlbann_1_1lbann__comm.html#a6c201108eb6b5a1e23021db29cef655b">get_model_rank</a>(), <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00160"></a>00160       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count * (<a class="code" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637">get_num_models</a>() - 1);
<a name="l00161"></a>00161     }
<a name="l00163"></a>00163     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00164"></a><a class="code" href="classlbann_1_1lbann__comm.html#aabcf342a505aa180d8e649a0d01974ba">00164</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#aabcf342a505aa180d8e649a0d01974ba">intermodel_reduce</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> root, mpi::Op op = mpi::SUM) {
<a name="l00165"></a>00165       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00166"></a>00166       mpi::Reduce(&amp;send, (T*) <a class="code" href="datatype_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, op, root, <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00167"></a>00167     }
<a name="l00169"></a>00169     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00170"></a><a class="code" href="classlbann_1_1lbann__comm.html#abf9a562b55c22befec5cffa68efe51b8">00170</a>     T <a class="code" href="classlbann_1_1lbann__comm.html#abf9a562b55c22befec5cffa68efe51b8">intermodel_reduce</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, mpi::Op op = mpi::SUM) {
<a name="l00171"></a>00171       T val;
<a name="l00172"></a>00172       mpi::Reduce(&amp;send, &amp;val, 1, op, <a class="code" href="classlbann_1_1lbann__comm.html#a6c201108eb6b5a1e23021db29cef655b">get_model_rank</a>(),
<a name="l00173"></a>00173                   <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>);
<a name="l00174"></a>00174       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * (<a class="code" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637">get_num_models</a>() - 1);
<a name="l00175"></a>00175       <span class="keywordflow">return</span> val;
<a name="l00176"></a>00176     }
<a name="l00178"></a>00178     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00179"></a><a class="code" href="classlbann_1_1lbann__comm.html#a9be50c5031bd02bd88c02f0d7aab57ea">00179</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a9be50c5031bd02bd88c02f0d7aab57ea">model_reduce</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> root, mpi::Op op = mpi::SUM) {
<a name="l00180"></a>00180       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00181"></a>00181       mpi::Reduce(&amp;send, (T*) <a class="code" href="datatype_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, op, root, <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00182"></a>00182     }
<a name="l00184"></a>00184     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00185"></a><a class="code" href="classlbann_1_1lbann__comm.html#a75a443fbbc5630812aed0e4b314c977a">00185</a>     T <a class="code" href="classlbann_1_1lbann__comm.html#a75a443fbbc5630812aed0e4b314c977a">model_reduce</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, mpi::Op op = mpi::SUM) {
<a name="l00186"></a>00186       T val;
<a name="l00187"></a>00187       mpi::Reduce(&amp;send, &amp;val, 1, op, <a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>(), <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00188"></a>00188       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * (<a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">get_procs_per_model</a>() - 1);
<a name="l00189"></a>00189       <span class="keywordflow">return</span> val;
<a name="l00190"></a>00190     }
<a name="l00192"></a>00192     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00193"></a><a class="code" href="classlbann_1_1lbann__comm.html#af8e280e2003d04a81b28e80eacf9c4a4">00193</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af8e280e2003d04a81b28e80eacf9c4a4">model_reduce</a>(T* <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> root, mpi::Op op = mpi::SUM) {
<a name="l00194"></a>00194       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00195"></a>00195       mpi::Reduce(send, (T*) <a class="code" href="datatype_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, count, op, root, <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00196"></a>00196     }
<a name="l00198"></a>00198     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00199"></a><a class="code" href="classlbann_1_1lbann__comm.html#a01cf8d635a761e03ef8b4b1a2531ec87">00199</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a01cf8d635a761e03ef8b4b1a2531ec87">model_reduce</a>(T* <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> count, T* <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>, mpi::Op op = mpi::SUM) {
<a name="l00200"></a>00200       mpi::Reduce(send, recv, count, op, <a class="code" href="classlbann_1_1lbann__comm.html#a206bafe522a0962c450f4fc69d030656">get_rank_in_model</a>(), <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00201"></a>00201       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count * (<a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">get_procs_per_model</a>() - 1);
<a name="l00202"></a>00202     }
<a name="l00204"></a>00204     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00205"></a><a class="code" href="classlbann_1_1lbann__comm.html#a735d6432d0a1ba7c5651355c6f24576b">00205</a>     T <a class="code" href="classlbann_1_1lbann__comm.html#a735d6432d0a1ba7c5651355c6f24576b">model_allreduce</a>(T <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, mpi::Op op = mpi::SUM) {
<a name="l00206"></a>00206       T val;
<a name="l00207"></a>00207       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T);
<a name="l00208"></a>00208       mpi::AllReduce(&amp;send, &amp;val, 1, op, <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00209"></a>00209       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * (<a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">get_procs_per_model</a>() - 1);
<a name="l00210"></a>00210       <span class="keywordflow">return</span> val;
<a name="l00211"></a>00211     }
<a name="l00213"></a>00213     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00214"></a><a class="code" href="classlbann_1_1lbann__comm.html#a5101192f2f8a1b40ab71e3ffb126a149">00214</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a5101192f2f8a1b40ab71e3ffb126a149">model_allreduce</a>(T* <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>, <span class="keywordtype">int</span> count, T* <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>, mpi::Op op = mpi::SUM) {
<a name="l00215"></a>00215       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += count * <span class="keyword">sizeof</span>(T);
<a name="l00216"></a>00216       mpi::AllReduce(send, recv, count, op, <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>);
<a name="l00217"></a>00217       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += count * <span class="keyword">sizeof</span>(T) * (<a class="code" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175">get_procs_per_model</a>() - 1);
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00221"></a>00221     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00222"></a><a class="code" href="classlbann_1_1lbann__comm.html#ac24c005bf5cec3dfcafbf54253e8d6f2">00222</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac24c005bf5cec3dfcafbf54253e8d6f2">wait</a>(lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00223"></a>00223       mpi::Wait(req);
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00227"></a>00227     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a5834e95e066313d9328b22e4a0ec8663">intermodel_barrier</a>();
<a name="l00229"></a>00229     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a6086ced12c3eefeea6e2a78eff286983">model_barrier</a>();
<a name="l00231"></a>00231     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ae12af95f4826571efa03fb8520260daa">global_barrier</a>();
<a name="l00232"></a>00232 
<a name="l00234"></a>00234     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00235"></a><a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">00235</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>(<span class="keyword">const</span> T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank) {
<a name="l00236"></a>00236       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00237"></a>00237       mpi::Send(data, count, <a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(model, rank), mpi::COMM_WORLD);
<a name="l00238"></a>00238     }
<a name="l00239"></a><a class="code" href="classlbann_1_1lbann__comm.html#a79bdb73b8d63608b18bd1786acda80d3">00239</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a79bdb73b8d63608b18bd1786acda80d3">send</a>(<span class="keyword">const</span> T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) {
<a name="l00240"></a>00240       <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>(data, count, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>);
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank);
<a name="l00243"></a>00243     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac7e32d53c55b0e0fc8b72ae943d997ce">send</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank);
<a name="l00244"></a><a class="code" href="classlbann_1_1lbann__comm.html#aa91c0587ae25a9824e6323002f59c040">00244</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#aa91c0587ae25a9824e6323002f59c040">send</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) { <a class="code" href="classlbann_1_1lbann__comm.html#aa91c0587ae25a9824e6323002f59c040">send</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>); }
<a name="l00245"></a><a class="code" href="classlbann_1_1lbann__comm.html#a1f8cff639b94813cb79963e2ce3d49da">00245</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a1f8cff639b94813cb79963e2ce3d49da">send</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) { <a class="code" href="classlbann_1_1lbann__comm.html#a1f8cff639b94813cb79963e2ce3d49da">send</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>); }
<a name="l00246"></a>00246 
<a name="l00248"></a>00248     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00249"></a><a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">00249</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(<span class="keyword">const</span> T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank,
<a name="l00250"></a>00250                  lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00251"></a>00251       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00252"></a>00252       mpi::ISend(data, count, <a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(model, rank), mpi::COMM_WORLD, req);
<a name="l00253"></a>00253     }
<a name="l00254"></a><a class="code" href="classlbann_1_1lbann__comm.html#ab8e30b6ce5bce96263ffd14ea5639202">00254</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(<span class="keyword">const</span> T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>,
<a name="l00255"></a>00255                                        lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00256"></a>00256       <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(data, count, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00259"></a>00259     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00260"></a><a class="code" href="classlbann_1_1lbann__comm.html#adc0fdfa0d5580b800265f2913effdb1d">00260</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#adc0fdfa0d5580b800265f2913effdb1d">nb_send</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, lbann_mpi_req&lt;DataType&gt;&amp; req) {
<a name="l00261"></a>00261       <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00262"></a>00262     }
<a name="l00263"></a><a class="code" href="classlbann_1_1lbann__comm.html#ad6c3bfd66f43ac55733f05436fbc141d">00263</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad6c3bfd66f43ac55733f05436fbc141d">nb_send</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, lbann_mpi_req&lt;DataType&gt;&amp; req) {
<a name="l00264"></a>00264       <a class="code" href="classlbann_1_1lbann__comm.html#a355a5b31dd50bd0fd6fb015621e0ba42">nb_send</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266 
<a name="l00268"></a><a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">00268</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank) {
<a name="l00269"></a>00269       mpi::Recv(data, count, <a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(model, rank), mpi::COMM_WORLD);
<a name="l00270"></a>00270       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00271"></a>00271     }
<a name="l00272"></a><a class="code" href="classlbann_1_1lbann__comm.html#a2b8fc6f6fe8a8f0084f09ba93c583a06">00272</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a2b8fc6f6fe8a8f0084f09ba93c583a06">recv</a>(T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) {
<a name="l00273"></a>00273       <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(data, count, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>);
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank);
<a name="l00276"></a>00276     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank);
<a name="l00277"></a><a class="code" href="classlbann_1_1lbann__comm.html#a6b1ecfe900346c0996fb8066e4f76fe2">00277</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a6b1ecfe900346c0996fb8066e4f76fe2">recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) { <a class="code" href="classlbann_1_1lbann__comm.html#a6b1ecfe900346c0996fb8066e4f76fe2">recv</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>); }
<a name="l00278"></a><a class="code" href="classlbann_1_1lbann__comm.html#a018f0451e2a984d28b6a1f099cf9d421">00278</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a018f0451e2a984d28b6a1f099cf9d421">recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) { <a class="code" href="classlbann_1_1lbann__comm.html#a018f0451e2a984d28b6a1f099cf9d421">recv</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>); }
<a name="l00280"></a><a class="code" href="classlbann_1_1lbann__comm.html#aa7040fda9b962f56cea9144f3d01dbcf">00280</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#aa7040fda9b962f56cea9144f3d01dbcf">recv</a>(T* data, <span class="keywordtype">int</span> count) {
<a name="l00281"></a>00281       mpi::Recv(data, count, mpi::ANY_SOURCE, mpi::COMM_WORLD);
<a name="l00282"></a>00282       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat);
<a name="l00285"></a>00285     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat);
<a name="l00286"></a>00286 
<a name="l00288"></a><a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">00288</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank,
<a name="l00289"></a>00289                                        lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00290"></a>00290       mpi::IRecv(data, count, <a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(model, rank), mpi::COMM_WORLD,
<a name="l00291"></a>00291                  req);
<a name="l00292"></a>00292       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00293"></a>00293     }
<a name="l00294"></a><a class="code" href="classlbann_1_1lbann__comm.html#a2895030f3d32838a8bdbc54aa3fe7ee3">00294</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(T* data, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>,
<a name="l00295"></a>00295                                        lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00296"></a>00296       <a class="code" href="classlbann_1_1lbann__comm.html#af3560cb26adf60212085e7b1d8e8dade">recv</a>(data, count, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00299"></a>00299     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00300"></a><a class="code" href="classlbann_1_1lbann__comm.html#a063f7f688d90e56a38da876b48a9769d">00300</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a063f7f688d90e56a38da876b48a9769d">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, lbann_mpi_req&lt;DataType&gt;&amp; req) {
<a name="l00301"></a>00301       <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00302"></a>00302     }
<a name="l00303"></a><a class="code" href="classlbann_1_1lbann__comm.html#a95efc824e4b93ac989cb7b246e77af4d">00303</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a95efc824e4b93ac989cb7b246e77af4d">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, lbann_mpi_req&lt;DataType&gt;&amp; req) {
<a name="l00304"></a>00304       <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(mat, model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>, req);
<a name="l00305"></a>00305     }
<a name="l00306"></a><a class="code" href="classlbann_1_1lbann__comm.html#ac3a26264a827a0ad9e6f1ebe0920be28">00306</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#ac3a26264a827a0ad9e6f1ebe0920be28">nb_recv</a>(T* data, <span class="keywordtype">int</span> count, lbann_mpi_req&lt;T&gt;&amp; req) {
<a name="l00307"></a>00307       mpi::IRecv(data, count, mpi::ANY_SOURCE, mpi::COMM_WORLD, req);
<a name="l00308"></a>00308       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> += <span class="keyword">sizeof</span>(T) * count;
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00311"></a>00311     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cbfb1de6aa32645d682d23d81c59927">nb_recv</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, lbann_mpi_req&lt;DataType&gt;&amp; req);
<a name="l00312"></a>00312 
<a name="l00314"></a><a class="code" href="classlbann_1_1lbann__comm.html#a1fa922b6520f44fc817847f7c596e25e">00314</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a1fa922b6520f44fc817847f7c596e25e">get_count</a>(<span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>, <span class="keywordtype">int</span> rank) {
<a name="l00315"></a>00315       MPI_Status status;
<a name="l00316"></a>00316       MPI_Probe(<a class="code" href="classlbann_1_1lbann__comm.html#a676b64be1b9429b85e8dac09728ba490">get_world_rank</a>(model, rank), MPI_ANY_TAG, MPI_COMM_WORLD, &amp;status);
<a name="l00317"></a>00317       <span class="keywordflow">return</span> mpi::GetCount&lt;T&gt;(status);
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00320"></a><a class="code" href="classlbann_1_1lbann__comm.html#a9754c9018bc9cb447ffe7312fdbaa87c">00320</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a9754c9018bc9cb447ffe7312fdbaa87c">get_count</a>(<span class="keywordtype">int</span> <a class="code" href="classlbann_1_1model.html">model</a>) { <span class="keywordflow">return</span> get_count&lt;T&gt;(model, <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>); }
<a name="l00321"></a>00321 
<a name="l00326"></a>00326     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;
<a name="l00327"></a><a class="code" href="classlbann_1_1lbann__comm.html#a02a95cf2854e3750590da55c51ff91d8">00327</a>     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a02a95cf2854e3750590da55c51ff91d8">broadcast</a>(T* data, <span class="keywordtype">int</span> count, std::vector&lt;int&gt;&amp; dests, <span class="keywordtype">int</span> root) {
<a name="l00328"></a>00328       mpi::Group bcast_group;
<a name="l00329"></a>00329       mpi::Comm bcast_comm;
<a name="l00330"></a>00330       std::vector&lt;int&gt; ranks;
<a name="l00331"></a>00331       ranks.push_back(root);
<a name="l00332"></a>00332       ranks.insert(ranks.end(), dests.begin(), dests.end());
<a name="l00333"></a>00333       <a class="code" href="classlbann_1_1lbann__comm.html#a07a25a3b0c46f15354fe6a69bcd292cb">create_group</a>(ranks, bcast_group);
<a name="l00334"></a>00334       <span class="comment">// Elemental doesn&apos;t expose this, so we have to reach into its internals.</span>
<a name="l00335"></a>00335       <span class="comment">// This lets us create a communicator without involving all of COMM_WORLD.</span>
<a name="l00336"></a>00336       <span class="comment">// Use a tag of 0; should not matter unless we&apos;re multi-threaded.</span>
<a name="l00337"></a>00337       MPI_Comm_create_group(mpi::COMM_WORLD.<a class="code" href="lbann__file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>, bcast_group.group, 0,
<a name="l00338"></a>00338                             &amp;(bcast_comm.comm));
<a name="l00339"></a>00339       <span class="keywordtype">int</span> translated_root = mpi::Translate(mpi::COMM_WORLD, root, bcast_comm);
<a name="l00340"></a>00340       mpi::Broadcast(data, count, translated_root, bcast_comm);
<a name="l00341"></a>00341       mpi::Free(bcast_comm);
<a name="l00342"></a>00342       mpi::Free(bcast_group);
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a02a95cf2854e3750590da55c51ff91d8">broadcast</a>(<a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; mat, std::vector&lt;int&gt;&amp; dests, <span class="keywordtype">int</span> root);
<a name="l00345"></a>00345     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a02a95cf2854e3750590da55c51ff91d8">broadcast</a>(<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; mat, std::vector&lt;int&gt;&amp; dests, <span class="keywordtype">int</span> root);
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="comment">// Statistics methods.</span>
<a name="l00349"></a><a class="code" href="classlbann_1_1lbann__comm.html#ad2ece549c49a0569ac8fd9b56632fdd2">00349</a> <span class="comment"></span>    <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad2ece549c49a0569ac8fd9b56632fdd2">get_num_model_barriers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#aa4f15459eca2a06174a877ba0c23feb7">num_model_barriers</a>; }
<a name="l00351"></a><a class="code" href="classlbann_1_1lbann__comm.html#a16c5b4574e98f5718ab9bff9a9c3c2bb">00351</a>     <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a16c5b4574e98f5718ab9bff9a9c3c2bb">get_num_intermodel_barriers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a03d946ef5ea5d3b15351e78a2eed10fe">num_intermodel_barriers</a>; }
<a name="l00353"></a><a class="code" href="classlbann_1_1lbann__comm.html#a4180e1e69474af10d5fb672404f3d845">00353</a>     <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a4180e1e69474af10d5fb672404f3d845">get_num_global_barriers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#a4f01e2f2d8220dc34cf39eb4a255cd7d">num_global_barriers</a>; }
<a name="l00355"></a><a class="code" href="classlbann_1_1lbann__comm.html#a8644cbef030e9e6e66e50753ef76a884">00355</a>     <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a8644cbef030e9e6e66e50753ef76a884">get_bytes_sent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a>; }
<a name="l00357"></a><a class="code" href="classlbann_1_1lbann__comm.html#a9b89b6f22a0566ec9ece14bde5ee6a66">00357</a>     <span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a9b89b6f22a0566ec9ece14bde5ee6a66">get_bytes_received</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a>; }
<a name="l00358"></a><a class="code" href="classlbann_1_1lbann__comm.html#adb9afab1b8af03276e6e6347f8021ef5">00358</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#adb9afab1b8af03276e6e6347f8021ef5">reset_stats_counters</a>() {
<a name="l00359"></a>00359       <a class="code" href="classlbann_1_1lbann__comm.html#aa4f15459eca2a06174a877ba0c23feb7">num_model_barriers</a> = 0;
<a name="l00360"></a>00360       <a class="code" href="classlbann_1_1lbann__comm.html#a03d946ef5ea5d3b15351e78a2eed10fe">num_intermodel_barriers</a> = 0;
<a name="l00361"></a>00361       <a class="code" href="classlbann_1_1lbann__comm.html#a4f01e2f2d8220dc34cf39eb4a255cd7d">num_global_barriers</a> = 0;
<a name="l00362"></a>00362       <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a> = 0;
<a name="l00363"></a>00363       <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a> = 0;
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365   <span class="keyword">private</span>:
<a name="l00367"></a><a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">00367</a>     mpi::Comm <a class="code" href="classlbann_1_1lbann__comm.html#a3a9eff49cac3746acd169889fda79893">model_comm</a>;
<a name="l00369"></a><a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">00369</a>     mpi::Comm <a class="code" href="classlbann_1_1lbann__comm.html#a4797dcdf39d18c4c8335dc012186a8b1">intermodel_comm</a>;
<a name="l00371"></a><a class="code" href="classlbann_1_1lbann__comm.html#a9f1f65663ca1d441f98f003b612eeb8c">00371</a>     mpi::Comm <a class="code" href="classlbann_1_1lbann__comm.html#a9f1f65663ca1d441f98f003b612eeb8c">node_comm</a>;
<a name="l00373"></a><a class="code" href="classlbann_1_1lbann__comm.html#a29fb31be115db3225b145f250a7778d9">00373</a>     <a class="code" href="lbann__base_8hpp.html#a4c600bf682fbf8018385607476e4bd13">Grid</a>* <a class="code" href="classlbann_1_1lbann__comm.html#a29fb31be115db3225b145f250a7778d9">grid</a>;
<a name="l00375"></a><a class="code" href="classlbann_1_1lbann__comm.html#a256ff5a0bafb33f43784ffc8dd2d29cf">00375</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a256ff5a0bafb33f43784ffc8dd2d29cf">num_models</a>;
<a name="l00377"></a><a class="code" href="classlbann_1_1lbann__comm.html#a7cb55d127259d7ed9f07ccde6f4ebd8c">00377</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a7cb55d127259d7ed9f07ccde6f4ebd8c">procs_per_model</a>;
<a name="l00379"></a><a class="code" href="classlbann_1_1lbann__comm.html#a1f3f90a996dbba4cd1cca60596933ea3">00379</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a1f3f90a996dbba4cd1cca60596933ea3">model_rank</a>;
<a name="l00381"></a><a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">00381</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a0dcccd57c2b591eb7682e192e0a09033">rank_in_model</a>;
<a name="l00383"></a><a class="code" href="classlbann_1_1lbann__comm.html#a2ffc59f0c1d97df2ca6845312c8c8b3e">00383</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a2ffc59f0c1d97df2ca6845312c8c8b3e">procs_per_node</a>;
<a name="l00385"></a><a class="code" href="classlbann_1_1lbann__comm.html#abb5c8b008b5cac11702bf1f991c78ab0">00385</a>     <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#abb5c8b008b5cac11702bf1f991c78ab0">rank_in_node</a>;
<a name="l00386"></a>00386     
<a name="l00387"></a>00387     <span class="comment">// Various statistics counters.</span>
<a name="l00388"></a><a class="code" href="classlbann_1_1lbann__comm.html#aa4f15459eca2a06174a877ba0c23feb7">00388</a>     <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#aa4f15459eca2a06174a877ba0c23feb7">num_model_barriers</a>;
<a name="l00389"></a><a class="code" href="classlbann_1_1lbann__comm.html#a03d946ef5ea5d3b15351e78a2eed10fe">00389</a>     <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a03d946ef5ea5d3b15351e78a2eed10fe">num_intermodel_barriers</a>;
<a name="l00390"></a><a class="code" href="classlbann_1_1lbann__comm.html#a4f01e2f2d8220dc34cf39eb4a255cd7d">00390</a>     <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#a4f01e2f2d8220dc34cf39eb4a255cd7d">num_global_barriers</a>;
<a name="l00391"></a><a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">00391</a>     <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#ad1f146ae7337ece6266fd307944928e0">bytes_sent</a>;
<a name="l00392"></a><a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">00392</a>     <span class="keywordtype">size_t</span> <a class="code" href="classlbann_1_1lbann__comm.html#afb99f57f7eafc0695bf28e6c26a8120f">bytes_received</a>;
<a name="l00393"></a>00393 
<a name="l00395"></a><a class="code" href="classlbann_1_1lbann__comm.html#a5650eece94f78b913f47aa2274853366">00395</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classlbann_1_1lbann__comm.html#a5650eece94f78b913f47aa2274853366">PT2PT_TAG</a> = 42;
<a name="l00397"></a><a class="code" href="classlbann_1_1lbann__comm.html#a07a25a3b0c46f15354fe6a69bcd292cb">00397</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a07a25a3b0c46f15354fe6a69bcd292cb">create_group</a>(std::vector&lt;int&gt;&amp; ranks, mpi::Group&amp; g) {
<a name="l00398"></a>00398       mpi::Group world_group;
<a name="l00399"></a>00399       mpi::CommGroup(mpi::COMM_WORLD, world_group);
<a name="l00400"></a>00400       mpi::Incl(world_group, (<span class="keywordtype">int</span>) ranks.size(), ranks.data(), g);
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402 
<a name="l00408"></a>00408     <span class="keywordtype">void</span> <a class="code" href="classlbann_1_1lbann__comm.html#a44bc6b8683f04c2a3fc2f01fc734a946">setup_node_comm</a>();
<a name="l00409"></a>00409     
<a name="l00410"></a>00410   };
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="preprocessor">#endif  // LBANN_COMM_HPP_INCLUDED</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 21 Sep 2016 for LBANN by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
