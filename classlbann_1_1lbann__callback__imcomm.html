<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LBANN: lbann::lbann_callback_imcomm Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
  <div class="navpath"><a class="el" href="namespacelbann.html">lbann</a>::<a class="el" href="classlbann_1_1lbann__callback__imcomm.html">lbann_callback_imcomm</a>
  </div>
<div class="contents">
<h1>lbann::lbann_callback_imcomm Class Reference</h1><!-- doxytag: class="lbann::lbann_callback_imcomm" --><!-- doxytag: inherits="lbann::lbann_callback" -->
<p><code>#include &lt;<a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for lbann::lbann_callback_imcomm:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm__inherit__graph.png" border="0" usemap="#lbann_1_1lbann__callback__imcomm_inherit__map" alt="Inheritance graph"/></div>
<map name="lbann_1_1lbann__callback__imcomm_inherit__map" id="lbann_1_1lbann__callback__imcomm_inherit__map">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback.html" title="lbann::lbann_callback" alt="" coords="33,5,180,35"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for lbann::lbann_callback_imcomm:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm__coll__graph.png" border="0" usemap="#lbann_1_1lbann__callback__imcomm_coll__map" alt="Collaboration graph"/></div>
<map name="lbann_1_1lbann__callback__imcomm_coll__map" id="lbann_1_1lbann__callback__imcomm_coll__map">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback.html" title="lbann::lbann_callback" alt="" coords="8,101,155,131"/><area shape="rect" id="node4" href="classlbann_1_1lbann__summary.html" title="lbann::lbann_summary" alt="" coords="5,5,157,35"/><area shape="rect" id="node6" href="classlbann_1_1lbann__quantizer.html" title="lbann::lbann_quantizer" alt="" coords="179,101,331,131"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classlbann_1_1lbann__callback__imcomm-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">comm_type</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03">NONE</a>, 
<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e">NORMAL</a>, 
<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33">ONEBIT_QUANTIZATION</a>, 
<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4">THRESH_QUANTIZATION</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f">COMPRESSED_THRESH_QUANTIZATION</a>, 
<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712">ADAPTIVE_THRESH_QUANTIZATION</a>, 
<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40">COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#aef048c5bdeb5b36d7b5e0fdfddfb6a7a">lbann_callback_imcomm</a> (<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">comm_type</a> <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>=NONE, <a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> *_summarizer=nullptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a84d47e38ad45417f88d32eb37d94ebbd">lbann_callback_imcomm</a> (<a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">comm_type</a> <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>, std::unordered_set&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> &gt; _layers, <a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> *_summarizer=nullptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a1cc160d368f1dd5bd30f1504c0df8003">setup</a> (<a class="el" href="classlbann_1_1model.html">model</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a9e409109c25b6173bc57108281e7aeb5">on_epoch_end</a> (<a class="el" href="classlbann_1_1model.html">model</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ace11211398e94728880476981f25fdc2">on_backward_prop_end</a> (<a class="el" href="classlbann_1_1model.html">model</a> *m)</td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d">ct_does_quantization</a> () const </td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">comm_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__quantizer.html">lbann_quantizer</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ab10f1484a37c6e6085329796dc7ef7c4">gradhistories</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Support inter-model communication after each mini-batch to synchronize gradient updates. This optionally supports quantizing the gradient updates before communication in order to reduce bandwidth requirements. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00046">46</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6a"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::comm_type" ref="acf7e894b3381e7f9b71020dc73594d6a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">lbann::lbann_callback_imcomm::comm_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03"></a><!-- doxytag: member="NONE" ref="acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03" args="" -->NONE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e"></a><!-- doxytag: member="NORMAL" ref="acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e" args="" -->NORMAL</em>&nbsp;</td><td>
<p>Do no gradient updates. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33"></a><!-- doxytag: member="ONEBIT_QUANTIZATION" ref="acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33" args="" -->ONEBIT_QUANTIZATION</em>&nbsp;</td><td>
<p>Simply sum gradient updates. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4"></a><!-- doxytag: member="THRESH_QUANTIZATION" ref="acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4" args="" -->THRESH_QUANTIZATION</em>&nbsp;</td><td>
<p>Do one-bit quantization with AdaGrad. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f"></a><!-- doxytag: member="COMPRESSED_THRESH_QUANTIZATION" ref="acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f" args="" -->COMPRESSED_THRESH_QUANTIZATION</em>&nbsp;</td><td>
<p>Do thresholded one-bit quantization. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712"></a><!-- doxytag: member="ADAPTIVE_THRESH_QUANTIZATION" ref="acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712" args="" -->ADAPTIVE_THRESH_QUANTIZATION</em>&nbsp;</td><td>
<p>Do compressed thresholded one-bit quantization. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40"></a><!-- doxytag: member="COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION" ref="acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40" args="" -->COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION</em>&nbsp;</td><td>
<p>Do adaptive thresholded one-bit quantization. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00048">48</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00048"></a>00048                  {
<a name="l00049"></a>00049     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03">NONE</a>,  
<a name="l00050"></a>00050     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e">NORMAL</a>,  
<a name="l00051"></a>00051     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33">ONEBIT_QUANTIZATION</a>,  
<a name="l00052"></a>00052     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4">THRESH_QUANTIZATION</a>,  
<a name="l00053"></a>00053     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f">COMPRESSED_THRESH_QUANTIZATION</a>,  
<a name="l00054"></a>00054     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712">ADAPTIVE_THRESH_QUANTIZATION</a>,  
<a name="l00055"></a>00055     <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40">COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION</a>,  
<a name="l00056"></a>00056   };
</pre></div></p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aef048c5bdeb5b36d7b5e0fdfddfb6a7a"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::lbann_callback_imcomm" ref="aef048c5bdeb5b36d7b5e0fdfddfb6a7a" args="(comm_type ct=NONE, lbann_summary *_summarizer=nullptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::lbann_callback_imcomm::lbann_callback_imcomm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">lbann_callback_imcomm::comm_type</a>&nbsp;</td>
          <td class="paramname"> <em>ct</em> = <code>NONE</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> *&nbsp;</td>
          <td class="paramname"> <em>_summarizer</em> = <code>nullptr</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Do inter-model gradient updates of the given type. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8cpp_source.html#l00035">35</a> of file <a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00036"></a>00036                                                                          :
<a name="l00037"></a>00037   <a class="code" href="classlbann_1_1lbann__callback.html#af4c9e2cf1c87cbf741bb0316f6f5fab2">lbann_callback</a>(1, _summarizer), <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>(<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>) {
<a name="l00038"></a>00038   
<a name="l00039"></a>00039 }

</pre></div></p>

</div>
</div>
<a class="anchor" id="a84d47e38ad45417f88d32eb37d94ebbd"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::lbann_callback_imcomm" ref="a84d47e38ad45417f88d32eb37d94ebbd" args="(comm_type ct, std::unordered_set&lt; uint &gt; _layers, lbann_summary *_summarizer=nullptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::lbann_callback_imcomm::lbann_callback_imcomm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">lbann_callback_imcomm::comm_type</a>&nbsp;</td>
          <td class="paramname"> <em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unordered_set&lt; <a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> &gt;&nbsp;</td>
          <td class="paramname"> <em>_layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> *&nbsp;</td>
          <td class="paramname"> <em>_summarizer</em> = <code>nullptr</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Do inter-model gradient updates of the given type, only for the layers in the layers set. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8cpp_source.html#l00041">41</a> of file <a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00043"></a>00043                                                                          :
<a name="l00044"></a>00044   <a class="code" href="classlbann_1_1lbann__callback.html#af4c9e2cf1c87cbf741bb0316f6f5fab2">lbann_callback</a>(1, _summarizer), <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>(<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>), <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>(_layers) {
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 }

</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad3a9f43ceb08af462ce9d378e70bd76d"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::ct_does_quantization" ref="ad3a9f43ceb08af462ce9d378e70bd76d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::lbann_callback_imcomm::ct_does_quantization </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return true if the comm type does quantization. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00086">86</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00086"></a>00086                                            {
<a name="l00087"></a>00087     <span class="keywordflow">return</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33">ONEBIT_QUANTIZATION</a> ||
<a name="l00088"></a>00088             <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4">THRESH_QUANTIZATION</a> ||
<a name="l00089"></a>00089             <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f">COMPRESSED_THRESH_QUANTIZATION</a> ||
<a name="l00090"></a>00090             <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712">ADAPTIVE_THRESH_QUANTIZATION</a> ||
<a name="l00091"></a>00091             <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40">COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION</a>);
<a name="l00092"></a>00092   }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm_ad3a9f43ceb08af462ce9d378e70bd76d_icgraph.png" border="0" usemap="#classlbann_1_1lbann__callback__imcomm_ad3a9f43ceb08af462ce9d378e70bd76d_icgraph_map" alt=""></div>
<map name="classlbann_1_1lbann__callback__imcomm_ad3a9f43ceb08af462ce9d378e70bd76d_icgraph_map" id="classlbann_1_1lbann__callback__imcomm_ad3a9f43ceb08af462ce9d378e70bd76d_icgraph">
<area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#ace11211398e94728880476981f25fdc2" title="lbann::lbann_callback_imcomm::on_backward_prop_end" alt="" coords="389,5,739,35"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__imcomm.html#a9e409109c25b6173bc57108281e7aeb5" title="lbann::lbann_callback_imcomm::on_epoch_end" alt="" coords="416,59,712,88"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__imcomm.html#a1cc160d368f1dd5bd30f1504c0df8003" title="lbann::lbann_callback_imcomm::setup" alt="" coords="443,112,685,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace11211398e94728880476981f25fdc2"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::on_backward_prop_end" ref="ace11211398e94728880476981f25fdc2" args="(model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::lbann_callback_imcomm::on_backward_prop_end </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1model.html">model</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Do inter-model gradient updates. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1lbann__callback.html#af183624e63ba65e0003fa988f53dee0c">lbann::lbann_callback</a>.</p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8cpp_source.html#l00111">111</a> of file <a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00111"></a>00111                                                          {
<a name="l00112"></a>00112   lbann_comm* <a class="code" href="lbann__file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a> = m-&gt;get_comm();
<a name="l00113"></a>00113   <span class="keywordflow">if</span> (comm-&gt;get_num_models() == 1 ||
<a name="l00114"></a>00114       m-&gt;get_execution_mode() != <a class="code" href="lbann__base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8aef839bdee87b9298d9be97d3f9c90469">execution_mode::training</a>) {
<a name="l00115"></a>00115     <span class="keywordflow">return</span>;  <span class="comment">// No point with only one model.</span>
<a name="l00116"></a>00116   }
<a name="l00117"></a>00117   std::vector&lt;Layer*&gt;&amp; layers = m-&gt;get_layers();
<a name="l00118"></a>00118   <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; layers.size(); ++l) {
<a name="l00119"></a>00119     <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.find(layers[l]-&gt;get_index()) == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.end()) {
<a name="l00120"></a>00120       <span class="keywordflow">continue</span>;
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122     <span class="keywordtype">double</span> start_time = <a class="code" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f">get_time</a>();
<a name="l00123"></a>00123     <span class="comment">// TODO: handle case where WB_D is in other matrix distribution</span>
<a name="l00124"></a>00124     <a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; WB_D = (<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp;) layers[l]-&gt;get_weights_biases_gradient();
<a name="l00125"></a>00125     <span class="keywordflow">switch</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a>) {
<a name="l00126"></a>00126     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03">NONE</a>:
<a name="l00127"></a>00127       <span class="keywordflow">break</span>;
<a name="l00128"></a>00128     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa5f19efb5bef79cea24be992a2137962e">NORMAL</a>:
<a name="l00129"></a>00129       comm-&gt;intermodel_sum_matrix(WB_D);
<a name="l00130"></a>00130       <span class="keywordflow">break</span>;
<a name="l00131"></a>00131     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33">ONEBIT_QUANTIZATION</a>:
<a name="l00132"></a>00132       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.intermodel_sum_quantized(
<a name="l00133"></a>00133         comm, WB_D, <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l], <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>[l], <span class="keyword">true</span>,
<a name="l00134"></a>00134         &amp;(<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab10f1484a37c6e6085329796dc7ef7c4">gradhistories</a>[l]));
<a name="l00135"></a>00135       <span class="keywordflow">break</span>;
<a name="l00136"></a>00136     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa76420a96a3df1d5b60140bab6bc32dc4">THRESH_QUANTIZATION</a>:
<a name="l00137"></a>00137       <span class="comment">// TODO: Don&apos;t hardcode thresholds.</span>
<a name="l00138"></a>00138       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.intermodel_sum_threshold_quantized(
<a name="l00139"></a>00139         comm, WB_D, <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l], 0.01f, -0.01f,
<a name="l00140"></a>00140         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>[l], <span class="keyword">false</span>);
<a name="l00141"></a>00141       <span class="keywordflow">break</span>;
<a name="l00142"></a>00142     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac76623c2ad49262ce5beb14170fbda9f">COMPRESSED_THRESH_QUANTIZATION</a>:
<a name="l00143"></a>00143       <span class="comment">// TODO: Don&apos;t hardcode thresholds.</span>
<a name="l00144"></a>00144       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.intermodel_sum_threshold_quantized(
<a name="l00145"></a>00145         comm, WB_D, <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l], 0.01f, -0.01f,
<a name="l00146"></a>00146         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>[l], <span class="keyword">true</span>);
<a name="l00147"></a>00147       <span class="keywordflow">break</span>;
<a name="l00148"></a>00148     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aada44a49f242f680c41e65f80150d1712">ADAPTIVE_THRESH_QUANTIZATION</a>:
<a name="l00149"></a>00149       <span class="comment">// TODO: Don&apos;t hardcode proportion.</span>
<a name="l00150"></a>00150       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.intermodel_sum_adaptive_threshold_quantized(
<a name="l00151"></a>00151         comm, WB_D, <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l], 64,
<a name="l00152"></a>00152         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>[l], <span class="keyword">false</span>);
<a name="l00153"></a>00153       <span class="keywordflow">break</span>;
<a name="l00154"></a>00154     <span class="keywordflow">case</span> <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aac3af83766cde0dfb183144d72f916f40">COMPRESSED_ADAPTIVE_THRESH_QUANTIZATION</a>:
<a name="l00155"></a>00155       <span class="comment">// TODO: Don&apos;t hardcode proportion.</span>
<a name="l00156"></a>00156       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.intermodel_sum_adaptive_threshold_quantized(
<a name="l00157"></a>00157         comm, WB_D, <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l], 64,
<a name="l00158"></a>00158         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>[l], <span class="keyword">true</span>);
<a name="l00159"></a>00159       <span class="keywordflow">break</span>;
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161     <span class="keywordtype">double</span> im_time = <a class="code" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f">get_time</a>() - start_time;
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> != <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03">NONE</a>) {
<a name="l00163"></a>00163       std::string prefix = <span class="stringliteral">&quot;layer&quot;</span> + std::to_string(
<a name="l00164"></a>00164         static_cast&lt;long long&gt;(layers[l]-&gt;get_index())) + <span class="stringliteral">&quot;/imcomm_&quot;</span>;
<a name="l00165"></a>00165       <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;time&quot;</span>,
<a name="l00166"></a>00166                                 im_time, m-&gt;get_cur_step());
<a name="l00167"></a>00167       <span class="keywordtype">size_t</span> bytes_sent = 0;
<a name="l00168"></a>00168       <span class="keywordtype">size_t</span> bytes_received = 0;
<a name="l00169"></a>00169       <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d">ct_does_quantization</a>()) {
<a name="l00170"></a>00170         bytes_sent = <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_bytes_sent();
<a name="l00171"></a>00171         bytes_received = <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_bytes_received();
<a name="l00172"></a>00172       } <span class="keywordflow">else</span> {
<a name="l00173"></a>00173         <span class="comment">// Use the same approximation the comm layer does.</span>
<a name="l00174"></a>00174         bytes_sent = <span class="keyword">sizeof</span>(<a class="code" href="lbann__base_8hpp.html#a279b64f47fb2213ad73e59be937afcfa">DataType</a>) * WB_D.LocalHeight() * WB_D.LocalWidth();
<a name="l00175"></a>00175         bytes_received = <span class="keyword">sizeof</span>(<a class="code" href="lbann__base_8hpp.html#a279b64f47fb2213ad73e59be937afcfa">DataType</a>) * WB_D.LocalHeight() * WB_D.LocalWidth();
<a name="l00176"></a>00176       }
<a name="l00177"></a>00177       <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;bytes_sent&quot;</span>,
<a name="l00178"></a>00178                                 bytes_sent, m-&gt;get_cur_step());
<a name="l00179"></a>00179       <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;bytes_received&quot;</span>,
<a name="l00180"></a>00180                                 bytes_received, m-&gt;get_cur_step());
<a name="l00181"></a>00181       <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d">ct_does_quantization</a>()) {
<a name="l00182"></a>00182         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;rs_bytes_sent&quot;</span>,
<a name="l00183"></a>00183                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_rs_bytes_sent(),
<a name="l00184"></a>00184                                   m-&gt;get_cur_step());
<a name="l00185"></a>00185         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;ag_bytes_sent&quot;</span>,
<a name="l00186"></a>00186                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_ag_bytes_sent(),
<a name="l00187"></a>00187                                   m-&gt;get_cur_step());
<a name="l00188"></a>00188         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;rs_bytes_received&quot;</span>,
<a name="l00189"></a>00189                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_rs_bytes_received(),
<a name="l00190"></a>00190                                   m-&gt;get_cur_step());
<a name="l00191"></a>00191         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;ag_bytes_received&quot;</span>,
<a name="l00192"></a>00192                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_ag_bytes_received(),
<a name="l00193"></a>00193                                   m-&gt;get_cur_step());
<a name="l00194"></a>00194         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;rs_send_trans_time&quot;</span>,
<a name="l00195"></a>00195                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_rs_send_trans_time(),
<a name="l00196"></a>00196                                   m-&gt;get_cur_step());
<a name="l00197"></a>00197         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;rs_recv_trans_time&quot;</span>,
<a name="l00198"></a>00198                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_rs_recv_trans_time(),
<a name="l00199"></a>00199                                   m-&gt;get_cur_step());
<a name="l00200"></a>00200         <a class="code" href="classlbann_1_1lbann__callback.html#ad48ff47a64f2dff3a12d8bd282f554cb">summarizer</a>-&gt;reduce_scalar(prefix + <span class="stringliteral">&quot;ag_recv_trans_time&quot;</span>,
<a name="l00201"></a>00201                                   <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.get_ag_recv_trans_time(),
<a name="l00202"></a>00202                                   m-&gt;get_cur_step());
<a name="l00203"></a>00203         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.reset_bytes_counters();
<a name="l00204"></a>00204         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">quantizer</a>.reset_time_counters();
<a name="l00205"></a>00205       }
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm_ace11211398e94728880476981f25fdc2_cgraph.png" border="0" usemap="#classlbann_1_1lbann__callback__imcomm_ace11211398e94728880476981f25fdc2_cgraph_map" alt=""></div>
<map name="classlbann_1_1lbann__callback__imcomm_ace11211398e94728880476981f25fdc2_cgraph_map" id="classlbann_1_1lbann__callback__imcomm_ace11211398e94728880476981f25fdc2_cgraph">
<area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d" title="lbann::lbann_callback_imcomm::ct_does_quantization" alt="" coords="452,5,785,35"/><area shape="rect" id="node5" href="classlbann_1_1lbann__quantizer.html#a9befb796840b21d1238e8169421005f9" title="lbann::lbann_quantizer::get_ag_bytes_received" alt="" coords="472,59,765,88"/><area shape="rect" id="node7" href="classlbann_1_1lbann__quantizer.html#a6c64c6960852ca25f81ba7bc80c05d2d" title="lbann::lbann_quantizer::get_ag_bytes_sent" alt="" coords="484,112,753,141"/><area shape="rect" id="node9" href="classlbann_1_1lbann__quantizer.html#aebc22819c53ce8a836bd20e938f6c59e" title="lbann::lbann_quantizer::get_ag_recv_trans_time" alt="" coords="469,165,768,195"/><area shape="rect" id="node11" href="classlbann_1_1lbann__quantizer.html#a9a029f692e679ac4475a51fa2ac8f7c1" title="lbann::lbann_quantizer::get_bytes_received" alt="" coords="483,219,755,248"/><area shape="rect" id="node13" href="classlbann_1_1lbann__quantizer.html#ad318aefe6f75c8d68363affce55f6190" title="lbann::lbann_quantizer::get_bytes_sent" alt="" coords="495,272,743,301"/><area shape="rect" id="node15" href="classlbann_1_1model.html#aa837a468e77991314053a93441d111ca" title="lbann::model::get_comm" alt="" coords="536,325,701,355"/><area shape="rect" id="node17" href="classlbann_1_1model.html#a6fb1e6b55fe9f7ecb70759a9c50a20c5" title="lbann::model::get_cur_step" alt="" coords="529,379,708,408"/><area shape="rect" id="node19" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="507,432,731,461"/><area shape="rect" id="node21" href="classlbann_1_1model.html#a45e75790d328ac2a85aac59faf35094a" title="lbann::model::get_layers" alt="" coords="537,485,700,515"/><area shape="rect" id="node23" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637" title="lbann::lbann_comm::get_num_models" alt="" coords="497,539,740,568"/><area shape="rect" id="node25" href="classlbann_1_1lbann__quantizer.html#aeefaa02ea30dc89f58420e019950207f" title="lbann::lbann_quantizer::get_rs_bytes_received" alt="" coords="473,592,764,621"/><area shape="rect" id="node27" href="classlbann_1_1lbann__quantizer.html#a2c1b69b38cf93d43e9b4eca7d4c5e28f" title="lbann::lbann_quantizer::get_rs_bytes_sent" alt="" coords="485,645,752,675"/><area shape="rect" id="node29" href="classlbann_1_1lbann__quantizer.html#ae5f4f573c3ed285265e9d7834446b3a0" title="lbann::lbann_quantizer::get_rs_recv_trans_time" alt="" coords="471,699,767,728"/><area shape="rect" id="node31" href="classlbann_1_1lbann__quantizer.html#aea9f348cd6f48b706870e1a5e48e8827" title="lbann::lbann_quantizer::get_rs_send_trans_time" alt="" coords="469,752,768,781"/><area shape="rect" id="node33" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f" title="lbann::get_time" alt="" coords="1701,673,1811,703"/><area shape="rect" id="node35" href="classlbann_1_1lbann__quantizer.html#a28e74da8473ea1b475ff3976676898c4" title="lbann::lbann_quantizer::intermodel_sum_adaptive_threshold_quantized" alt="" coords="404,936,833,965"/><area shape="rect" id="node56" href="classlbann_1_1lbann__comm.html#a68b36ba64db34f33cb135bc64c4623e0" title="lbann::lbann_comm::intermodel_sum_matrix" alt="" coords="480,1040,757,1069"/><area shape="rect" id="node58" href="classlbann_1_1lbann__quantizer.html#a97db186341c0819c8d52e2f815deb2a7" title="lbann::lbann_quantizer::intermodel_sum_quantized" alt="" coords="461,856,776,885"/><area shape="rect" id="node72" href="classlbann_1_1lbann__quantizer.html#a4cf9d4cd5262b21939e95fc34ad0a09f" title="lbann::lbann_quantizer::intermodel_sum_threshold_quantized" alt="" coords="884,1229,1257,1259"/><area shape="rect" id="node84" href="classlbann_1_1lbann__summary.html#aacd54e77d45bd1bd56df3a4d71c01ce8" title="lbann::lbann_summary::reduce_scalar" alt="" coords="497,1093,740,1123"/><area shape="rect" id="node86" href="classlbann_1_1lbann__quantizer.html#afa32b747b7ac0dbea8df3b47593d54b7" title="lbann::lbann_quantizer::reset_bytes_counters" alt="" coords="476,1147,761,1176"/><area shape="rect" id="node88" href="classlbann_1_1lbann__quantizer.html#abdba3762c51a2820f70adba32169f57b" title="lbann::lbann_quantizer::reset_time_counters" alt="" coords="480,1200,757,1229"/><area shape="rect" id="node37" href="classlbann_1_1lbann__quantizer.html#a8b920e254dcdc72b5a4785c740389dfe" title="lbann::lbann_quantizer::adaptive_threshold_quantize" alt="" coords="908,1016,1233,1045"/><area shape="rect" id="node44" href="classlbann_1_1lbann__quantizer.html#a28e08719534c503f452f7627d9c9c400" title="lbann::lbann_quantizer::adaptive_threshold_unquantize" alt="" coords="901,1123,1240,1152"/><area shape="rect" id="node46" href="classlbann_1_1lbann__quantizer.html#a888effd26dfa024c28f591dda74bd464" title="lbann::lbann_quantizer::adaptive_threshold_unquantize_add" alt="" coords="888,963,1253,992"/><area shape="rect" id="node48" href="classlbann_1_1lbann__quantizer.html#a6e75d7f48c309ed184c4de0b9e56c4bb" title="lbann::lbann_quantizer::compress_adaptive_thresholds" alt="" coords="901,1069,1240,1099"/><area shape="rect" id="node52" href="classlbann_1_1lbann__quantizer.html#a02e4bdf26d23de079d763300e71488f1" title="lbann::lbann_quantizer::uncompress_adaptive_thresholds" alt="" coords="893,1176,1248,1205"/><area shape="rect" id="node39" href="classlbann_1_1lbann__quantizer.html#a621ce88c0a961cfdb00c94ab24d659e0" title="lbann::lbann_quantizer::proportion_threshold_average" alt="" coords="1307,803,1637,832"/><area shape="rect" id="node41" href="namespacelbann.html#a4fea7ba21017b49d1e34394b4c20c764" title="lbann::get_generator" alt="" coords="1687,777,1825,807"/><area shape="rect" id="node50" href="classlbann_1_1lbann__quantizer.html#ad8d07c3ffddff08800887dff354ffed2" title="lbann::lbann_quantizer::compress_thresholds" alt="" coords="1331,1096,1613,1125"/><area shape="rect" id="node54" href="classlbann_1_1lbann__quantizer.html#afb58d63b174c3a937f3c3b21eb269b77" title="lbann::lbann_quantizer::uncompress_thresholds" alt="" coords="1323,1163,1621,1192"/><area shape="rect" id="node60" href="lbann__layer__fully__connected_8cpp.html#a199b2df97e18b083eb9ee655fec2dfc7" title="_sq" alt="" coords="1049,803,1092,832"/><area shape="rect" id="node62" href="lbann__layer__fully__connected_8cpp.html#afc141da3841a084e603a2e8db5b4a839" title="_sqrt" alt="" coords="1045,856,1096,885"/><area shape="rect" id="node64" href="classlbann_1_1lbann__quantizer.html#a52820f8b0868a7f8f3a57ade0c663c3c" title="lbann::lbann_quantizer::get_quantized_matrix_height" alt="" coords="1309,699,1635,728"/><area shape="rect" id="node66" href="classlbann_1_1lbann__quantizer.html#a3801d9cd1a1adefb160b69dbd7e499ef" title="lbann::lbann_quantizer::quantize" alt="" coords="967,749,1175,779"/><area shape="rect" id="node70" href="classlbann_1_1lbann__quantizer.html#a8eb42b16ff79799e3e81733b7921a789" title="lbann::lbann_quantizer::unquantize" alt="" coords="960,909,1181,939"/><area shape="rect" id="node75" href="classlbann_1_1lbann__quantizer.html#a00106e69ea8a6dfe9e9a91c75b845bcd" title="lbann::lbann_quantizer::threshold_quantize" alt="" coords="1337,1323,1607,1352"/><area shape="rect" id="node77" href="classlbann_1_1lbann__quantizer.html#a8871704ae757f1bd83f3948d61b1cdad" title="lbann::lbann_quantizer::threshold_quantize_apply" alt="" coords="1319,1376,1625,1405"/><area shape="rect" id="node79" href="classlbann_1_1lbann__quantizer.html#a0f5f3b0149715ab59202b8884a87c7d5" title="lbann::lbann_quantizer::threshold_unquantize" alt="" coords="1331,1216,1613,1245"/><area shape="rect" id="node81" href="classlbann_1_1lbann__quantizer.html#a94d55b41dd60582f4412d5e24a0eeffe" title="lbann::lbann_quantizer::threshold_unquantize_apply" alt="" coords="1312,1269,1632,1299"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9e409109c25b6173bc57108281e7aeb5"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::on_epoch_end" ref="a9e409109c25b6173bc57108281e7aeb5" args="(model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::lbann_callback_imcomm::on_epoch_end </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1model.html">model</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clear out remaining error if needed. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1lbann__callback.html#a1fc71110e7f754bf73c9e0f344a448a5">lbann::lbann_callback</a>.</p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8cpp_source.html#l00087">87</a> of file <a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00087"></a>00087                                                  {
<a name="l00088"></a>00088   lbann_comm* <a class="code" href="lbann__file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a> = m-&gt;get_comm();
<a name="l00089"></a>00089   <span class="keywordflow">if</span> (comm-&gt;get_num_models() == 1 ||
<a name="l00090"></a>00090       m-&gt;get_execution_mode() != <a class="code" href="lbann__base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8aef839bdee87b9298d9be97d3f9c90469">execution_mode::training</a>) {
<a name="l00091"></a>00091     <span class="keywordflow">return</span>;  <span class="comment">// No point with only one model.</span>
<a name="l00092"></a>00092   }
<a name="l00093"></a>00093   <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d">ct_does_quantization</a>()) {
<a name="l00094"></a>00094     std::vector&lt;Layer*&gt;&amp; layers = m-&gt;get_layers();
<a name="l00095"></a>00095     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; layers.size(); ++l) {
<a name="l00096"></a>00096       <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.find(layers[l]-&gt;get_index()) == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.end()) {
<a name="l00097"></a>00097         <span class="keywordflow">continue</span>;
<a name="l00098"></a>00098       }
<a name="l00099"></a>00099       comm-&gt;intermodel_sum_matrix(<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l]);
<a name="l00100"></a>00100       <span class="comment">// TODO: handle case where WB_D is in other matrix distribution</span>
<a name="l00101"></a>00101       <a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; WB_D = (<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp;) layers[l]-&gt;get_weights_biases_gradient();
<a name="l00102"></a>00102       <a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&amp; local_mat = WB_D.Matrix();
<a name="l00103"></a>00103       local_mat = <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l];
<a name="l00104"></a>00104       <span class="comment">// Apply optimizer update again.</span>
<a name="l00105"></a>00105       layers[l]-&gt;update();
<a name="l00106"></a>00106       <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>[l].Empty();
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm_a9e409109c25b6173bc57108281e7aeb5_cgraph.png" border="0" usemap="#classlbann_1_1lbann__callback__imcomm_a9e409109c25b6173bc57108281e7aeb5_cgraph_map" alt=""></div>
<map name="classlbann_1_1lbann__callback__imcomm_a9e409109c25b6173bc57108281e7aeb5_cgraph_map" id="classlbann_1_1lbann__callback__imcomm_a9e409109c25b6173bc57108281e7aeb5_cgraph">
<area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d" title="lbann::lbann_callback_imcomm::ct_does_quantization" alt="" coords="351,5,684,35"/><area shape="rect" id="node5" href="classlbann_1_1model.html#aa837a468e77991314053a93441d111ca" title="lbann::model::get_comm" alt="" coords="435,59,600,88"/><area shape="rect" id="node7" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="405,112,629,141"/><area shape="rect" id="node9" href="classlbann_1_1model.html#a45e75790d328ac2a85aac59faf35094a" title="lbann::model::get_layers" alt="" coords="436,165,599,195"/><area shape="rect" id="node11" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637" title="lbann::lbann_comm::get_num_models" alt="" coords="396,219,639,248"/><area shape="rect" id="node13" href="classlbann_1_1lbann__comm.html#a68b36ba64db34f33cb135bc64c4623e0" title="lbann::lbann_comm::intermodel_sum_matrix" alt="" coords="379,272,656,301"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1cc160d368f1dd5bd30f1504c0df8003"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::setup" ref="a1cc160d368f1dd5bd30f1504c0df8003" args="(model *m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::lbann_callback_imcomm::setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1model.html">model</a> *&nbsp;</td>
          <td class="paramname"> <em>m</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Do initialization for this <a class="el" href="classlbann_1_1model.html">model</a>. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1lbann__callback.html#aab5086e27d9bb0a7c7ee8ffc1bc58671">lbann::lbann_callback</a>.</p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8cpp_source.html#l00048">48</a> of file <a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00048"></a>00048                                           {
<a name="l00049"></a>00049   <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> != <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aafa59156bc4d5bcbf6bd80918d062da03">NONE</a>) {
<a name="l00050"></a>00050     <span class="keywordtype">bool</span> add = <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.size() == 0;
<a name="l00051"></a>00051     std::vector&lt;Layer*&gt;&amp; layers = m-&gt;get_layers();
<a name="l00052"></a>00052     <span class="keywordflow">for</span> (Layer* layer : layers) {
<a name="l00053"></a>00053       <a class="code" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idx = layer-&gt;get_index();
<a name="l00054"></a>00054       <span class="keywordflow">if</span> (add || <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.find(idx) != <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.end()) {
<a name="l00055"></a>00055         <span class="comment">// Ensure index is present (overwrites if already there).</span>
<a name="l00056"></a>00056         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">layer_indices</a>.insert(idx);
<a name="l00057"></a>00057         <span class="comment">// Update the layer&apos;s effective mini-batch size so it averages properly.</span>
<a name="l00058"></a>00058         layer-&gt;set_effective_minibatch_size(
<a name="l00059"></a>00059           layer-&gt;get_minibatch_size() * m-&gt;get_comm()-&gt;get_num_models());
<a name="l00060"></a>00060         <span class="comment">// Skip adding matrices when we don&apos;t need to.</span>
<a name="l00061"></a>00061         <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d">ct_does_quantization</a>()) <span class="keywordflow">continue</span>;
<a name="l00062"></a>00062         <span class="comment">// TODO: handle case where WB_D is in other matrix distribution</span>
<a name="l00063"></a>00063         <a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp; WB_D = (<a class="code" href="lbann__base_8hpp.html#a270ddda44ad6a3abd3cfe8358cf581e6">DistMat</a>&amp;) layer-&gt;get_weights_biases_gradient();
<a name="l00064"></a>00064         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">quantization_errors</a>.emplace(idx, <a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>{});
<a name="l00065"></a>00065         <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">im_quantization_errors</a>.emplace(idx, <a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>{});
<a name="l00066"></a>00066         <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">ct</a> == <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6aa06f19090efbd982638c20bcb8a3c7d33">ONEBIT_QUANTIZATION</a>) {
<a name="l00067"></a>00067           <span class="comment">// Set up gradient history and SGD optimizer for one-bit quantization.</span>
<a name="l00068"></a>00068           <a class="code" href="classlbann_1_1lbann__callback__imcomm.html#ab10f1484a37c6e6085329796dc7ef7c4">gradhistories</a>.emplace(idx, <a class="code" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>{});
<a name="l00069"></a>00069           <span class="keywordflow">if</span> (layer-&gt;optimizer != <span class="keyword">nullptr</span>) {
<a name="l00070"></a>00070             <span class="keywordflow">if</span> (<span class="keyword">typeid</span>(*(layer-&gt;optimizer)) != <span class="keyword">typeid</span>(Adagrad&lt;DistMat&gt;)) {
<a name="l00071"></a>00071               <span class="keywordflow">throw</span> lbann_exception(
<a name="l00072"></a>00072                 <span class="stringliteral">&quot;lbann_callback_imcomm: Cannot do one-bit quantization for &quot;</span>
<a name="l00073"></a>00073                 <span class="stringliteral">&quot;layer that does not use Adagrad&quot;</span>);
<a name="l00074"></a>00074             }
<a name="l00075"></a>00075             <span class="comment">// TODO: This leaks the old optimizer.</span>
<a name="l00076"></a>00076             layer-&gt;optimizer = <span class="keyword">new</span> SGD&lt;DistMat&gt;(
<a name="l00077"></a>00077               layer-&gt;comm, layer-&gt;optimizer-&gt;get_learning_rate(),
<a name="l00078"></a>00078               0.0f, 0.0f, <span class="keyword">false</span>);
<a name="l00079"></a>00079             layer-&gt;optimizer-&gt;setup(layer-&gt;WB-&gt;Width(), layer-&gt;WB-&gt;Height());
<a name="l00080"></a>00080           }
<a name="l00081"></a>00081         }
<a name="l00082"></a>00082       }
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="classlbann_1_1lbann__callback__imcomm_a1cc160d368f1dd5bd30f1504c0df8003_cgraph.png" border="0" usemap="#classlbann_1_1lbann__callback__imcomm_a1cc160d368f1dd5bd30f1504c0df8003_cgraph_map" alt=""></div>
<map name="classlbann_1_1lbann__callback__imcomm_a1cc160d368f1dd5bd30f1504c0df8003_cgraph_map" id="classlbann_1_1lbann__callback__imcomm_a1cc160d368f1dd5bd30f1504c0df8003_cgraph">
<area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#ad3a9f43ceb08af462ce9d378e70bd76d" title="lbann::lbann_callback_imcomm::ct_does_quantization" alt="" coords="300,5,633,35"/><area shape="rect" id="node5" href="classlbann_1_1model.html#aa837a468e77991314053a93441d111ca" title="lbann::model::get_comm" alt="" coords="384,59,549,88"/><area shape="rect" id="node7" href="classlbann_1_1model.html#a45e75790d328ac2a85aac59faf35094a" title="lbann::model::get_layers" alt="" coords="385,112,548,141"/><area shape="rect" id="node9" href="classlbann_1_1lbann__comm.html#a54842b679a3756cf79b43baf46caf637" title="lbann::lbann_comm::get_num_models" alt="" coords="345,165,588,195"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa617c54b0bba0aaba9a916c0cda2cfba"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::ct" ref="aa617c54b0bba0aaba9a916c0cda2cfba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acf7e894b3381e7f9b71020dc73594d6a">comm_type</a> <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#aa617c54b0bba0aaba9a916c0cda2cfba">lbann::lbann_callback_imcomm::ct</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Communication type. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00073">73</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab10f1484a37c6e6085329796dc7ef7c4"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::gradhistories" ref="ab10f1484a37c6e6085329796dc7ef7c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&gt; <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ab10f1484a37c6e6085329796dc7ef7c4">lbann::lbann_callback_imcomm::gradhistories</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Per-layer gradient history when using one-bit quantization. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00081">81</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab4c3627c1cd73ca8fc994918a4adbe7a"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::im_quantization_errors" ref="ab4c3627c1cd73ca8fc994918a4adbe7a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&gt; <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#ab4c3627c1cd73ca8fc994918a4adbe7a">lbann::lbann_callback_imcomm::im_quantization_errors</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Per-layer inter-model sum quantization errors. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00079">79</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8a6db1ae85f466653f6d3b3bdef9f0e6"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::layer_indices" ref="a8a6db1ae85f466653f6d3b3bdef9f0e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;<a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&gt; <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a8a6db1ae85f466653f6d3b3bdef9f0e6">lbann::lbann_callback_imcomm::layer_indices</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Layers indicies to quantize. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00083">83</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a55de5c89215eb0b0ebc9186cf7a0f5e6"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::quantization_errors" ref="a55de5c89215eb0b0ebc9186cf7a0f5e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="datatype_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>, <a class="el" href="lbann__base_8hpp.html#a483ed30937584c6d3a4d76bff5215a34">Mat</a>&gt; <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#a55de5c89215eb0b0ebc9186cf7a0f5e6">lbann::lbann_callback_imcomm::quantization_errors</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Per-layer quantization errors. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00077">77</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acb4f04304f91457885902812f354d9a7"></a><!-- doxytag: member="lbann::lbann_callback_imcomm::quantizer" ref="acb4f04304f91457885902812f354d9a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1lbann__quantizer.html">lbann_quantizer</a> <a class="el" href="classlbann_1_1lbann__callback__imcomm.html#acb4f04304f91457885902812f354d9a7">lbann::lbann_callback_imcomm::quantizer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Quantizer for quantization of updates, if needed. </p>

<p>Definition at line <a class="el" href="lbann__callback__imcomm_8hpp_source.html#l00075">75</a> of file <a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/lbann/callbacks/<a class="el" href="lbann__callback__imcomm_8hpp_source.html">lbann_callback_imcomm.hpp</a></li>
<li>src/callbacks/<a class="el" href="lbann__callback__imcomm_8cpp_source.html">lbann_callback_imcomm.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 21 Sep 2016 for LBANN by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
